

const Book2Model = require("../models/NewbookModels")
const authorMdal = require("../models/authorsModal")
const publisherModel =require("../models/pabliserModels")
const mongoose = require("mongoose")

const createBook2 = async function (req, res) {
    let Book2 = req.body
    let authoId = req.body.author
    let publisherId=req.body.pabliser
    let authorFromRequest = await authorMdal.findById(authoId)
    let publisherFromRequest = await publisherModel.findById(publisherId)
    if (authorFromRequest && publisherFromRequest) {
        let savedBook2 = await Book2Model.create(Book2);
        res.send({ msg: savedBook2 })
    } else {
        res.send("The author id is provide is wrong")
    }

}

const getAllBook = async function (req, res) {
    let allBook = await Book2Model.find().populate('author',{author_name:1,age:1}).populate('pabliser',{pabliser_name:1,headQuarter:1})
    res.send({ msg: allBook })
}

// const priceUpdate = async function (req, res) {
//     let value=req.body
//     let allUsers = await Book2Model.findOneAndUpdate(value, { price: 100 }, { new: true }).select({ author_id: 1, _id: 0 })
//     let bookwillbe = await Book2Model.findOne(value).select({ name: 1, price: 1, ratings: 1, _id: 0 })
//     let savedData = await authorMdal.findOne(allUsers).select({ author_name: 1, author_id: 1, age: 1, address: 1, _id: 0 })

//     res.send({ AuthorNameDetails: savedData, UpdatedBookPrice: bookwillbe })
// }
// const findbook = async function (req, res) {
//     let allUsers = await Book2Model.find({ $and: [{ price: { $gte: 50 } }, { price: { $lte: 100 } }] }).select({ author_id: 1, _id: 0 })
//     let savedata = await authorMdal.find({ $or: allUsers }).select({ author_name: 1, author_id: 1, age: 1, address: 1, _id: 0 })
//     res.send({ msg: savedata })
// }

// const findByName = async function (req, res) {
//     let findName = await Book2Model.find({ sales: { $in: [50, 100] } }).select({ name: 1, _id: 0 })
//     res.send({ msg: findName })
// }


// const getBookByAuthorName = async function (req, res) {
//     let authorDetaels = await authorMdal.findOne({ author_name: "Chetan Bhagat" })
//     let authorId = authorDetaels.author_id
//     let authorsBook = await Book2Model.find({ author_id: authorId }).select({ name: 1, _id: 0 })
//     res.send({ msg: authorsBook })
// }


// const FindByName = async function (req, res) {
//     let FindName = await Book2Model.find({ sales: { $in: [50, 100,] } }).select({ Name: 1 })
//     res.send({ msg: FindName })
// }

//module.exports.getBookByAuthorName = getBookByAuthorName
module.exports.createBook2 = createBook2
module.exports.getAllBook = getAllBook
//module.exports.priceUpdate = priceUpdate
//module.exports.FindByName = FindByName
//module.exports.findByName = findByName
//module.exports.findbook = findbook