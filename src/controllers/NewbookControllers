

const Book2Model = require("../models/NewbookModels")
const authorMdal = require("../models/authorsModal")
const publisherModel = require("../models/pabliserModels")
const mongoose = require("mongoose")

const createBook2 = async function (req, res) {
    let Book2 = req.body

    let authoId = req.body.author

    let publisherId = req.body.pabliser

    let authorFromRequest = await authorMdal.findById(authoId)

    let publisherFromRequest = await publisherModel.findById(publisherId)

    if (authorFromRequest && publisherFromRequest) {

        let savedBook2 = await Book2Model.create(Book2);

        res.send({ msg: savedBook2 })

    } else {

        res.send("The author id is provide is wrong")
    }

}

const getAllBook = async function (req, res) {

    let allBook = await Book2Model.find().populate('author', { author_name: 1, age: 1 }).populate('pabliser', { pabliser_name: 1, headQuarter: 1 })

    res.send({ msg: allBook })
}

module.exports.createBook2 = createBook2

module.exports.getAllBook = getAllBook
